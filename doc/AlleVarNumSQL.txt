CREATE VIEW AlleVarNum AS
SELECT 
  patient.ID as PatientID,
                patient.REGISTERED_DATE as PatRegDate,
                patient.SSN,
                patient.SSN_TYPE as SSNType,
  patient.BIRTH_DATE as BirthDate,
  patient.NATIVE_LANGUAGE as NativeLanguage,
  patient.NATIVE_LANGUAGE_OTHER as NativeLangOther,
  patient.NORWEGIAN as PatientNorwegian,
  null AS Postnr,       
  null as PostSted,
  null as Kommune,
  null as Fylke,    
  patient.EDUCATION as Education,
  patient.DECEASED as PatientDeceased,
  patient.DECEASED_DATE as PatientDeceasedDate, 
  patient.MARITAL_STATUS as MaritalStatus,
  mce.MCEID,
  mce.CENTREID as CentreId,
  mce.CALLS_MADE as MCECallsMade,
  mce.DELIVERY_DATE as MCEDD,
  operation.HEIGHT as OpHeight,
  operation.WEIGHT as OpWeight,
  operation.BMI as OpBMI,
  operation.BMI_CATEGORY as OpBMICategory,
  operation.PREGNANCIES as OpPregnancies,
  operation.PARITIES as OpParities,
  operation.EARLIER_VAGINAL as OpEarlierVaginal,
  operation.VAG_REVISIO as OpVagRevisio,
  operation.VAG_HYSTEROSCOPY as OpVagHysteroscopy,
  operation.VAG_CONISATION as OpVagConisation,
  operation.VAG_DESCENS as OpVagDescens,
  operation.EARLIER_LAPAROSCOPY as OpEarlierLaparoscopy,
  operation.LAPARASCOPY_COUNT as OpLapCount, 
  operation.EARLIER_LAPAROTOMY as OpEarlierPaparotomy,
  operation.GYNECOLOGICAL_SURGERY_COUNT as OpGynSurgeryCount,
  operation.SECTIO_COUNT as OpSectioCount,
  operation.OTHER_COUNT as OpOtherCount,
  operation.COMORBIDITY_HEART as OpComorbHeart,
  operation.COMORBIDITY_DIABETES as OpComorbDiabetes,
  operation.COMORBIDITY_HYPERTENSION as OpComorbHypertension,
  operation.COMORBIDITY_CANCER as OpComorbCancer,
  operation.COMORBIDITY_CANCER_CERVIX_UTERI as OpComorbCancerCervixUteri,
  operation.COMORBIDITY_CANCER_CAVUM_UTERI as OpComorbCancerCavumUteri,
  operation.COMORBIDITY_CANCER_OVAR as OpComorbCancerOvar,
  operation.COMORBIDITY_CANCER_INTESTINAL as OpComorbCancerIntestinal,
  operation.COMORBIDITY_CANCER_BLADDER as OpComorbCancerBladder,
  operation.COMORBIDITY_CANCER_MAMMA as OpComorbCancerMamma,
  operation.COMORBIDITY_CANCER_OTHER as OpComorbCancerOther,
  operation.COMORBIDITY_OTHER as OpComorbOther,
  operation.OP_DATE as OpDate,
  operation.OPTYPE as OpType,  
  operation.COMPLICATION as OpComp,  
  operation.MAIN_OPERATION as MainOperation,
  operation.COMPLICATION_TYPE as ComplType,  
  operation.OPCAT as Opcat,  
  operation.OPCAT_OUTSIDE_DAYTIME as OpOpcatOutsideDaytime,
  operation.MCETYPE as OpType,  
  operation.DAY_SURGERY as OpDaySurgery,  
  operation.OP_INDICATION1 as OpInd1,
  operation.OP_INDICATION2 as OpInd2,
  operation.OP_INDICATION3 as OpInd3,
  operation.ANAESTHETIC as OpAnesthetic,  
  operation.ASA as OpASA,    
  operation.OPTIME_COUNT as OpOptimeCount,
  operation.ANTIBIOTIC_PROPHYLAXIS as OpAntibioticProphylaxis,      
  operation.SURVIVED as OpSurvived,      
  operation.STATUS as StatusOp,
  laparoscopy.DIAGNOSIS1 as LapDiag1,
  laparoscopy.DIAGNOSIS2 as LapDiag2,
  laparoscopy.DIAGNOSIS3 as LapDiag3,
  laparoscopy.PROCEDURE1 as LapProc1,
  laparoscopy.PROCEDURE2 as LapProc2,
  laparoscopy.PROCEDURE3 as LapProc3,
  laparoscopy.NON_ENDO_COMBO as LapNonEC,
  laparoscopy.ACCESS_METHOD as LapTilgangsMetode,
  laparoscopy.ACCESS as LapTilgang,
  laparoscopy.NUM_HJELPEINNSTIKK as LapNumHjelpeinnstikk,
  laparoscopy.SINGELPORT as LapSingelPort,
  laparoscopy.BIPOLAR_DIATERMI as LapBipolarDiatermi,
  laparoscopy.UNIPOLAR_DIATERMI as LapUnipolarDiatermi,
  laparoscopy.HARMONIC_SCALPELL as LapHarmonicS,
  laparoscopy.THUNDERBEAT as LapIntKombo,
  laparoscopy.INTELLIGENTCOAG as LapIntKoagOgKlipp,
  laparoscopy.MORCELLATOR as LapMorcellatorUtenPose,
  laparoscopy.MORCELLATOR_WITH_BAG as LapMorcellatorMedPose,
  laparoscopy.SUTUR as LapSutur,
  laparoscopy.CLIPS as LapClips,
  laparoscopy.NETT as LapNett,
  laparoscopy.ADHERANSEPROFYLAXE as LapAdheanseprofylakse,
  laparoscopy.STAPLER_ENDOGIA as LapStaplerEndogia,
  laparoscopy.PREPARATOPOSE as LapPreparatopose,
  laparoscopy.ROBOT_KIRURGI as LapRobotKirurgi,
  laparoscopy.OTHER as LapOther,
  laparoscopy.MEDICATIONWITHDRAWAL as LapPrepUttak,
  laparoscopy.COMPLICATIONS as LapComplications,   
  laparoscopy.TILGANG as LapKompTilgang,
  laparoscopy.HJELPEINSTIKK as LapHjelpeinnstikk,
  laparoscopy.PORTIOADAPTER as LapProtoadapter,
  laparoscopy.POSTOPERATIV as LapPostoperativ,
  laparoscopy.TEKNISK_UTSTYR as LapTekniskUtstyr,
  laparoscopy.INTRAABDOMINAL as LapIntraAbdominal,
  laparoscopy.KAR_BLEED as LapKarBleed,
  laparoscopy.TARM as LapTarm,
  laparoscopy.BLAERE as LapBlaere,
  laparoscopy.URETER as LapUreter,
  laparoscopy.NERV as LapNerv,
  laparoscopy.CONVERTED as LapConverted,   
  laparoscopy.STATUS as StatusLap,
  hysteroscopy.DIAGNOSIS1 as HypDiag1,
  hysteroscopy.DIAGNOSIS2 as HypDiag2,
  hysteroscopy.DIAGNOSIS3 as HypDiag3,
  hysteroscopy.PROCEDURE1 as HypProc1,
  hysteroscopy.PROCEDURE2 as HypProc2,
  hysteroscopy.PROCEDURE3 as HypProc3,
  hysteroscopy.NON_ENDO_COMBO as HypNonEC,   
  hysteroscopy.DISTENTION_COMBO as HypDistentionCombo,   
  hysteroscopy.BIPOLAR_DIATHERMY as HypBipolarDiathermy,
  hysteroscopy.UNIPLOAR_DIATHERMY as HypUnipolarDiatermi,
  hysteroscopy.MORCELLATOR as HypMorcellator,
  hysteroscopy.PRETREATMENT_COMBO as HypPretreatmentCombo,   
  hysteroscopy.FLEXIBLE_LESS_OR_EQUAL_4MM as HypFlexLE4mm,
  hysteroscopy.FLEXIBLE_GREATER_4MM as HypFlexG4mm,
  hysteroscopy.RIGID_LESS_OR_EQUAL_4MM as HypRigidLE4mm,
  hysteroscopy.RIGID_GREATER_4MM as HypRigidG4mm, 
  hysteroscopy.COMPLICATIONS as HypComplications,  
  hysteroscopy.ACCESS as HypAccess,
  hysteroscopy.TECHNICAL as HypTechnical,
  hysteroscopy.PERFORATION as HypPerforation,
  hysteroscopy.BLEEDING as HypBleeding,
  hysteroscopy.FLUID_OVERLOAD as HypFluidOverload,
  hysteroscopy.COMPLETENESS as HypCompleteness,  
  hysteroscopy.CONVERTED as HypConverted,    
  hysteroscopy.CONVERTED_LAPAROSCOPY as HypCLaparoscopy,    
  hysteroscopy.CONVERTED_LAPROTOMY as HypCLaparotomy,    
  hysteroscopy.STATUS as StatusHyp,
  followup.FOLLOWUP_TYPE as FollowupType,  
  followup.COMPLICATIONS_EXIST as ComplExist,  
  followup.COMPLICATIONTYPE_REOP as ComplReop,  
  followup.COMPLICATIONTYPE_REOP_SPECIFY_LAPAROSCOPY as ComplReopLaparoscopy,
  followup.COMPLICATIONTYPE_REOP_SPECIFY_HYSTEROSCOPY as ComplReopHysteroscopy,
  followup.COMPLICATIONTYPE_REOP_SPECIFY_LAPAROTOMY as ComplReopLaparotomy,
  followup.COMPLICATIONTYPE_INFECTION as ComplInfection, 
  followup.COMPLICATIONTYPE_INFECTION_SPECIFY_SURG_WOUND as ComplInfSurg,
  followup.COMPLICATIONTYPE_INFECTION_SPECIFY_INTRAABD as ComplInfIntra,
  followup.COMPLICATIONTYPE_INFECTION_SPECIFY_ENDO_SALPIN as ComplInfEndoSalpin,
  followup.COMPLICATIONTYPE_INFECTION_SPECIFY_UVI as ComplInfUVI,
  followup.COMPLICATIONTYPE_INFECTION_SPECIFY_OTHER as ComplInfOther,
  followup.COMPLICATIONTYPE_AFTERBLEED as ComplAfterBleed, 
  followup.COMPLICATIONTYPE_AFTERBLEED_SPECIFY_ABDOMWALL as ComplAfterBleedAbdom,
  followup.COMPLICATIONTYPE_AFTERBLEED_SPECIFY_VAGINAL as ComplAfterBleedVaginal,
  followup.COMPLICATIONTYPE_AFTERBLEED_SPECIFY_INTRAABD as ComplAfterBleedIntra,
  followup.COMPLICATIONTYPE_ORGAN as ComplOrgan, 
  followup.COMPLICATIONTYPE_ORGAN_SPECIFY_INTESTINAL as ComplOrganIntestinal,
  followup.COMPLICATIONTYPE_ORGAN_SPECIFY_BLADDER as ComplOrganBladder,
  followup.COMPLICATIONTYPE_ORGAN_SPECIFY_URETER as ComplOrganUreter,
  followup.COMPLICATIONTYPE_ORGAN_SPECIFY_KAR as ComplOrganKar,
  followup.COMPLICATIONTYPE_ORGAN_SPECIFY_OTHER as ComplOrganOther,
  followup.COMPLICATIONTYPE_EQUIPMENT as ComplEquipment,   
  followup.COMPLICATIONTYPE_EQUIPMENT_SPECIFY_NET as ComplEquipNet,
  followup.COMPLICATIONTYPE_EQUIPMENT_SPECIFY_INSTRUMENTS as ComplEquipInstruments,
  followup.COMPLICATIONTYPE_EQUIPMENT_SPECIFY_SUTURE as ComplEquipSuture,
  followup.SERIOUSNESS as FollowupSeriousness,   
  followup.STATUS as StatusFollowup

FROM mce INNER JOIN patient ON mce.PATIENT_ID = patient.ID 
    INNER JOIN operation on mce.MCEID = operation.MCEID
    LEFT OUTER JOIN laparoscopy ON mce.MCEID = laparoscopy.MCEID
    LEFT OUTER JOIN hysteroscopy ON mce.MCEID = hysteroscopy.MCEID   
    LEFT OUTER JOIN followup ON mce.MCEID = followup.MCEID
ORDER BY patient.ID;

